<!DOCTYPE html>
<!-- saved from url=(0104)http://api.wandlm.com:808/public/index.php/notice/index/noticedetails?notice_id=58d376027e2fde0a8c0c3603 -->
<html lang="en" style="font-size: 42.6667px;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <meta name="viewport" content="width=device-width,minimum-scale=0.5,maximum-scale=1.0,initial-scale=1.0,user-scalable=no">
        <meta name="format-detection" content="telephone=no">
        <meta http-equiv="pragma" content="no-cache"> 
        <meta http-equiv="Cache-Control" content="no-cache, must-revalidate"> 
        <meta http-equiv="expires" content="Wed, 26 Feb 1997 08:21:57 GMT">
        <title>求购页面</title>
        <link rel="stylesheet" href="__CSS__/notice/taskDetail.css">
        <script src="__JS__/notice/rem.js"></script>
        <script src="__JS__/notice/zepto.js"></script>
        <script src="__JS__/notice/touch.min.js"></script>
        <script src="__JS__/notice/laytpl.js"></script>

    </head>
    <body>
        <section data-info='<?php echo $data?>'>
            
        </section>

        <script type="text/html" id="dataTpl">
            <div class="sendInfo">

            {{# if(d.notice_data.notice_type[0]=='103'){ }}
              <div class="count-down" data-time="1500794040000">
                    <div class="text-fix" id="timestamp"></div>
                </div>
            {{# } }}
                <div class="sendtitle">
                    <p><span>{{d.notice_data.title}}</span><span class="price">{{d.notice_data.value}}<span></p>
                </div>

                <div class="baseInfo">
                    <div class="personInfo">
                        <div class="personSendInfo" data-type="3">
                            <dl>
                                <dt>
                                    <img src="{{d.notice_data.promulgator.pic}}" alt="">
                                </dt>
                                <dd>

                                    <h3>
                                        <span>{{d.notice_data.promulgator.name}}</span>
                                        <!--<em class="mutiltype">
                                            <i>当前价</i> ￥<b>665.00</b>
                                        </em>-->
                                    </h3>
                                    <h5>
                                        <span class="leftTime" data-time="{{d.notice_data.login_time}}">
                                            <i style="font-style: normal">4分钟前来过，发布于</i><em>{{d.notice_data.addressdes.city}}</em>
                                        </span>
                                        <!--<em class="mutiltype font-pay">起拍价:￥555.00</em>-->
                                        
                                    </h5>
                                    {{#  if(d.notice_data.notice_type[0]=='103'){ }}
                                    <div class="typeSale">
                                        拍卖                                        <p>
                                            <span>￥</span>
                                            <b>{{}}</b>
                                        </p>
                                        
                                    </div>
                                    {{# } }}
                                    <!--线上服务-->
                                    {{# if(d.notice_data.mode){ }}
                                    <span class="service"><i style="border:none;"><img src="__IMG__/notice/computer.png" style="width:100%;height:100%;vertical-align:middle;" /></i>{{d.notice_data.mode==1?'线上服务':'线下服务'}}</span>
                                    {{# } }}

                                </dd>
                            </dl>

                        </div>
                        <p>
                            <span>#{{d.notice_data.classify.name}}#</span>{{d.notice_data.des}}                            
                        </p>
                    </div>
                                        <div class="img-content">
                        <div class="img-wrapper">
                            {{# for(var i=0,j=d.notice_data.pic.length;i<j;i++){ }}        
                                <div class="img-single">
                                    <img src="{{d.notice_data.pic[i]}}" alt="">
                                </div>
                            {{# } }}
                        
                        
                                               
                            
                        
                        
                                              </div>
                    </div>
                                        <div class="role-browse">
                        
                        <div class="browseWrap">
                            <div class="thumb-up">
<!--                                <img src="/public/static/i/notice/icon-thumb.png"></img>-->
                                <span>点赞 {{d.notice_data.like.size}}</span>
                            </div>
                            <div class="browse-num">
                                <!--<img src="/public/static/i/notice/icon-browse.png"></img>-->
                                <span>留言 {{d.notice_data.leave_num}}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!--其他用户显示区-->
                <!--其他用户显示区-->
            <div class="otherBaseInfo">
                <div class="record-price">
                    <h4 class="title-baseInfo">
                        <div class="touchOpacityArea" data-id="58d376027e2fde0a8c0c3603"></div>
                        <!--<img class="conImage" src="/public/static/i/notice/icon-record.png" alt="">-->
                        <span class="conTitle">出价记录</span>
                        <div class="right-price">
                            <img src="./求购页面_files/clickmore.png" style="width:0.12rem;height:0.24rem;">
                        </div>
                    </h4>
                    <div class="record-content">
                    {{# if(d.notice_data.suitors){ }}
                        {{# for (var i = 0; i < d.notice_data.suitors.length; i++) { }}
                            
                            <div class="single-person-area">
                                <div class="left-name">
                                    <span>
                                        <img src="{{=d.notice_data.suitors[i].pic}}" alt="">
                                    </span>
                                    <em>
                                         {{=d.notice_data.suitors[i].name}}
                                    </em>
                                </div>
                                <div class="contact-name">
                                   {{=d.notice_data.suitors[i].timeLeave}}
                                </div>
                            </div>

                        {{#  }; }}

                    {{# } }} 
                        
                        
                        
                    </div>
                    <div class="find-more">
                        
                    </div>
                </div>
                <div class="leave-message">
                    <h4 class="title-baseInfo">
                       
                        留言
                    </h4>
                    <div class="leave-mess-content">
                        {{# for (var i = 0; i < d.leave_data.length; i++) { }}
                             <div class="single-mess-area">
                                <div class="title-name-time">
                                    <div class="left-name">
                                        <span>
                                            <img src="{{d.leave_data[i].user.pic}}" alt="">
                                        </span>
                                        <em>
                                            {{=d.leave_data[i].user.name}}
                                        </em>     
                                    </div>
                                    <div class="right-price">
                                        {{=new Date(d.leave_data[i].createtime*1000).toLocaleString()}}
                                    </div>
                                </div>
                                <p>
                                    {{=d.leave_data[i].des}}
                                </p>
                            </div>
                        {{# } }}
                        
                        
                    </div> 
                </div>
            </div>
               
            </div>
        </script>
    
    <script>

        function getTimeShow(timestamp) {
                // var $e = $(ele).find('span');

                var now = new Date();
                var leftTime = now.getTime() - timestamp;
                var leftsecond = parseInt(leftTime / 1000);
                
                //var day1=parseInt(leftsecond/(24*60*60*6)); 
                var day1 = Math.floor(leftsecond / (60 * 60 * 24));
                var hour = Math.floor(leftsecond / 3600);
                var minute = Math.floor(leftsecond / 60);
                var second = Math.floor(leftsecond - day1 * 24 * 60 * 60 - hour * 3600 - minute * 60);

                if (day1 > 0) {
                    return day1 + '天前';
                } else if (hour > 0) {
                    return hour + '小时前';
                } else if (minute > 0) {
                    return minute + '分钟前';
                } else {
                    return '刚刚';
                }
            }


        function tapToAndroid(goodId) {
            phone.CallBack(goodId);
        }

        var strTime='';
        var browser = {
            versions: (function () {
                var u = navigator.userAgent, app = navigator.appVersion;
                return {
                    //移动终端浏览器版本信息
                    trident: u.indexOf('Trident') > -1, //IE内核
                    presto: u.indexOf('Presto') > -1, //opera内核
                    webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
                    gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
                    mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
                    ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
                    android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或uc浏览器
                    iPhone: u.indexOf('iPhone') > -1, //是否为iPhone或者QQHD浏览器
                    iPad: u.indexOf('iPad') > -1, //是否iPad
                    webApp: u.indexOf('Safari') == -1 //是否web应该程序，没有头部与底部
                };
            })(),
            language: (navigator.browserLanguage || navigator.language).toLowerCase()
        }


        $('section').on('tap','.touchOpacityArea',function () {
            var gId = $(this).data('id');
            if (browser.versions.ios) {
                alert(location.href);
                location.href = "notice://" + gId;
                console.log(location.href)
            } else {
                tapToAndroid(gId);
            }


        })

        var interval = 1000;

        function ShowCountDown(timestamp, divname) {
            var now = new Date();
            var endDate = new Date(timestamp);
            var leftTime = endDate.getTime() - now.getTime();
            var leftsecond = parseInt(leftTime / 1000);
            //var day1=parseInt(leftsecond/(24*60*60*6)); 
            var day1 = Math.floor(leftsecond / (60 * 60 * 24));
            var hour = Math.floor((leftsecond - day1 * 24 * 60 * 60) / 3600);
            var minute = Math.floor((leftsecond - day1 * 24 * 60 * 60 - hour * 3600) / 60);
            var second = Math.floor(leftsecond - day1 * 24 * 60 * 60 - hour * 3600 - minute * 60);
            var cc = document.getElementById(divname);
            cc.innerHTML = "距离拍卖结束时间 " + '<span>' + hour + '</span>:<em>' + minute + '</em>:<i>' + second + '</i>';
            //cc.innerHTML = "距离拍卖结束时间"+year+"年"+month+"月"+day+"日还有："+day1+"天"+hour+"小时"+minute+"分"+second+"秒"; 
            if(leftTime<=0){
                 cc.innerHTML = "交易已关闭";
                return;
            }
            setTimeout(function(){
                ShowCountDown(cutdowntime, 'timestamp');
            },1000)
        }
        var $ct = $('.count-down');
        var cutdowntime = $ct.data('time');
        if (!cutdowntime) {
            $ct.hide();
        } else {
            ShowCountDown(cutdowntime, 'timestamp');
        }

        function getTimeed(timestamp, ele) {
            var $e = $(ele);

            var now = new Date();
            var leftTime =-timestamp+now.getTime();
            var leftsecond = parseInt(leftTime / 1000);
//            console.log(leftsecond, leftTime);
            //var day1=parseInt(leftsecond/(24*60*60*6)); 
            var day1 = Math.floor(leftsecond / (60 * 60 * 24));
            var hour = Math.floor(leftsecond / 3600);
            var minute = Math.floor(leftsecond / 60);
            var second = Math.floor(leftsecond - day1 * 24 * 60 * 60 - hour * 3600 - minute * 60);
            
            if (day1 > 0) {
                $e.find('').html(day1 + '天前来过，发布于');
            } else if (hour > 0) {
                $e.find('i').html(hour + '小时前来过，发布于');
            } else if (minute > 0) {
                $e.find('i').html(minute + '分钟前来过，发布于');
            } else {
                $e.find('i').html('刚来过，发布于');
            }
        }
        function getTimeShow01(timestamp, ele) {
            var $e = $(ele).find('span');

            var now = new Date();
            var leftTime = now.getTime() - timestamp;
            var leftsecond = parseInt(leftTime / 1000);
            
            //var day1=parseInt(leftsecond/(24*60*60*6)); 
            var day1 = Math.floor(leftsecond / (60 * 60 * 24));
            var hour = Math.floor(leftsecond / 3600);
            var minute = Math.floor(leftsecond / 60);
            var second = Math.floor(leftsecond - day1 * 24 * 60 * 60 - hour * 3600 - minute * 60);

            if (day1 > 0) {
                $e.html(day1 + '天前');
            } else if (hour > 0) {
                $e.html(hour + '小时前');
            } else if (minute > 0) {
                $e.html(minute + '分钟前');
            } else {
                $e.html('刚刚');
            }
        }
        var ttime = $('.leftTime').data('time');
        getTimeed(ttime, '.leftTime')
        /**
         * @param {Number} type更新类型
         * 1，一口价
         * 2，置换
         * 3，拍卖
         * 4，求购
         */
        function updatePageCon(type){
            $('.conImage').attr('src','/public/static/i/notice/icon-want.png');
            if(type==1){
                $('.mutiltype').hide();
                $('.typeSale').show();
                $('.conTitle').text('想要的人');
            }else if(type==2){
                $('.mutiltype').hide();
                $('.typeSale').show();
                $('.conTitle').text('他们想跟你置换');
            }else if(type==3){
                $('.mutiltype').show();
                $('.typeSale').hide();
                $('.conTitle').text('出价记录');
                $('.conImage').attr('src','/public/static/i/notice/icon-record.png');
            }else if(type==4){
                $('.mutiltype').hide();
                $('.typeSale').show();
                $('.conTitle').text('这些人有ta想要的');
            }
        }
        var perType=$('.personSendInfo').data('type');
        updatePageCon(perType);
        
        $('.isTime').each(function(){
            var isShowTime=$(this).data('time').trim();
            if(isShowTime){
                getTimeShow(isShowTime,this);
            }else{
                $(this).find('span').hide();
            }
        })

        var tplData=$('section').data('info');
        
        if(tplData.notice_data.suitors){
            tplData.notice_data.suitors.forEach(function(item){
                item.timeLeave=getTimeShow(item.createtime*1000);
            })
        }
        var tpl=$('#dataTpl').html();
        laytpl(tpl).render(tplData,function(html){
            $('section').append(html);
        })

        
        
    </script>
</body></html>